{% extends "base.html" %}
{% block content %}
<div class="shell">
  <div class="workspace">
    <aside class="agent-console hidden" id="agent-console">
      <div class="agent-console__heading">
        <h4>Agents</h4>
        <p>Live view of every researcher and strategist.</p>
      </div>
      <ul class="agent-console__list" id="agent-console-list"></ul>
    </aside>
    <div class="main-stack">
      <div class="tab-controls">
      <button type="button" class="tab-button active" data-tab="chat">Conversation</button>
      <button type="button" class="tab-button" data-tab="research" id="research-tab">Research Feed</button>
      <button type="button" class="tab-button disabled" data-tab="plan" id="plan-tab" disabled>Account Plan</button>
      </div>
      <section class="chat-area tab-panel active" id="chat-panel">
      <div class="hero" id="hero">
        <h2>How can I help you today?</h2>
        <p>I can research any company, ask clarifying questions, and craft a tailored enterprise account plan.</p>
        <ul>
          <li>Describe the company and goal you have in mind.</li>
          <li>I will expand the scope and share a transparent workplan.</li>
          <li>Approve it to launch the researcher + strategist agents.</li>
        </ul>
      </div>
      <div class="chat-window" id="chat-window">
        <div class="chat-message assistant">
          <strong>Assistant:</strong>
          <p>Hi! Tell me which company you would like me to research.</p>
        </div>
      </div>
        <form id="chat-form">
          <input type="text" id="chat-input" placeholder="Type your message" autocomplete="off" required />
          <button type="submit">Send</button>
          <button type="button" id="mic-button" title="Use microphone" aria-label="Use microphone">
            <svg class="mic-icon" viewBox="0 0 24 24" aria-hidden="true">
              <path class="mic-body" d="M12 5.5c1.1 0 2 .9 2 2v5c0 1.1-.9 2-2 2s-2-.9-2-2v-5c0-1.1.9-2 2-2z"></path>
              <path d="M7.5 12v1c0 2.5 2 4.5 4.5 4.5s4.5-2 4.5-4.5v-1"></path>
              <path d="M12 17.5v3.5"></path>
              <path d="M9.5 21h5"></path>
            </svg>
            <span class="sr-only">Use microphone</span>
          </button>
        </form>
      </section>
      <section class="research-panel tab-panel hidden" id="research-panel">
      <div class="research-panel__intro">
        <h3>Research Feed</h3>
        <p>Each agent call and source will appear here once you approve the workplan.</p>
      </div>
      <ul class="research-activity-list" id="research-activity-list">
        <li class="research-activity-list__empty">No searches yet. Approve the workplan to watch the agents in action.</li>
      </ul>
      </section>
      <section class="plan-panel tab-panel hidden" id="plan-panel">
      <div class="plan-panel__header">
        <div>
          <h3>Account Plan</h3>
          <p>Review the generated plan, refresh sections, or export to PDF.</p>
        </div>
        <div class="plan-actions">
          <button id="refresh-plan" type="button">Refresh Plan</button>
          <button id="download-pdf" type="button">Download PDF</button>
        </div>
      </div>
      <div class="plan-panel__body" id="plan-container">
        <p>No plan yet. Approve the workplan to generate one.</p>
      </div>
      <div class="sources">
        <h4>Sources</h4>
        <ul id="sources-list"></ul>
      </div>
      </section>
    </div>
  </div>
</div>
<div class="progress-overlay hidden" id="progress-overlay">
  <div class="progress-overlay__content">
    <h3 id="progress-overlay-title">Researchingâ€¦</h3>
    <p class="progress-overlay__subtitle">Sit tight while the research and analysis agents work through the plan.</p>
    <ul id="overlay-progress-list"></ul>
  </div>
</div>
<div class="modal-backdrop hidden" id="regen-modal-backdrop"></div>
<div class="modal hidden" id="regen-modal" role="dialog" aria-modal="true" aria-labelledby="regen-modal-title">
  <div class="modal__card">
    <h3 id="regen-modal-title">Refine this section</h3>
    <p class="modal__subtitle">How should I improve this part of the account plan? Mention details, emphasis, or tone.</p>
    <form id="regen-form">
      <label for="regen-instruction" class="sr-only">Refinement guidance</label>
      <textarea id="regen-instruction" placeholder="e.g., Focus on EMEA AI deals and reference recent funding" rows="4" required></textarea>
      <div class="modal__actions">
        <button type="button" class="ghost" id="regen-cancel">Cancel</button>
        <button type="submit" class="primary" id="regen-submit">Apply refinement</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
